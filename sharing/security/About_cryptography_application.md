# 聊聊 "密评"

Author: WingWJ

Date: 22nd, Apr, 2022

<br/>

近期，得到了负责项目 高分通过"密评"测试的消息。作为技术负责人，还是很欣慰的。

自己这半年来的持续投入，对新国标新领域 从陌生到逐步理解；在后续工作践行中，逐步确认并落实解决各实现；与第三方安全厂商/测评机构，反复确认方案及核对场景；最终确保了项目 如期顺利通过测评。

这里，也把此次密评的内容总结一下，也算对之前这段日子的一段纪念。

以下，不会讨论/解释具体条目的解读及实现方法，尽量从条例整体来解读，确保让读者能了解"密评"的含义、内容、方式及价值。

<br/>

## 什么是 "密评"？

首先，先聊聊需求。

"密评"，有时会被称为"国密"、商用密码应用评估"。原始需求，其实来源于一份新国标，全称为《GB/T 39786-2021 信息安全技术 信息系统密码应用基本要求》，是于去年（2021年）10月1日正式生效的推荐型标准；官方文档可直接在国家标准信息平台上查询到 ，具体见[这里](http://c.gb688.cn/bzgk/gb/showGb?type=online&hcno=53282C88712CE157043B7A2C590278FC)。**标准覆盖对象为涉及/提供政务云应用的数据中心**。该标准是基于传统"商用密码"领域的行业标准，伴随国家"信创"大潮，逐步演进而来。主要实施意义，在于保证相关数据中心、业务应用等，采用国家认证的密码方法来实现，防止不安全算法/实现，危害国家安全；也间接的尝试摆脱对国外密码技术的部分依赖。

注意，相关条例要求，是针对具体实施项目而来，面向整个数据中心；而不是单单对IaaS层 的要求。其中，<u>技术标准中，对数据中心及云平台的要求，大致各占一半</u>。对于规范内容来说：

- 整体考察标准，分为五级；一般认为各级别类同于"等保2.0" 规范（*下文详述*）中的级别，最高第5级要求 不在标准里罗列。各级数据中心，只允许承载不高于其商用密码等级的应用
- 其中，条例含**技术**与**管理**两大类：
  - 前者，为标准核心要求，包括四大部分，从底层数据中心基建到具体应用，逐层进行了规范：
    - 物理和环境安全
    - 网络和通信安全
    - 设备和计算安全
    - 应用和数据安全
  - 后者，主要明确了符合商用密码要求的数据中心，需要遵循的非技术保障能力。包括：
    - 管理制度
    - 人员管理
    - 建设运行
    - 应急处置
- 各领域要求，以"应"、"宜"、"可" 三个级别进行定义
  - "应"：表示该条例，原则上均需要实施
  - "宜"：表示该条例建议实施
  - "可"：表示可选，由送测单位选定是否适用。不适用 需给出解释
- 具体技术要求，要求点不少，但归根结底就是一句话：**使用认证（国密局）设备，来替换并承载原有使用国际通用密码的实现**

以上，是标准本身的一些基础信息。

<br/>

## 与"等保2.0" 的区别

"等保2.0"，全称《GB/T 22239-2019 网络安全等级保护基本要求》，由原先使用多年的"1.0"标准（GB/T 22239-2008）升级而来。除了在原有通用技术要求基础上进行了增补之外，又根据业界新技术的发展动向，针对四大新兴领域（云计算、移动互联网、物联网、工业控制）分别制定了细分的扩展安全要求。

在结构要求上，分为技术、管理两大部分。在技术部分提出了五大类要求，分别是：物理环境、通信网络、区域边界、计算环境、及新增的安全管理中心。如下图：

<img src="https://s1.ax1x.com/2022/04/22/L2u0JI.png" alt="classified_protection_of_cybersecurity.png" style="zoom:50%;" />

同上面"密评" 标准对比，能看出 两者在大体结构上是类似的。而实际上"密评"在制定时也是参考了"等保2.0" 的内容，只是在内容要求上，更侧重实际场景中对密码应用的考察。（*~~另一个原因：是牵头制定单位不一样。。~~*）

多说一句：

- 在此项目中使用的云平台，已满足"等保2.0" 诉求；从2020年起，也是我作为技术负责人，历经两个版本落地的  ：）
- 所以，此次云平台"密评"改造中，部分能力已具备；我只需在增量上完成"密评"改造方案 即可

<br/>

## 实施要点

还是从需求分析入手。先看下技术类的要求，按四大领域进行分析：

- 物理和环境安全：主要考察数据中心基建。按要求采用满足条件的设备建设即可
- 网络和通信安全：**为数据中心改造重点**。需要数据中心能够提供安全可靠的传输信道。这个分为几个维度，如运维管理、用户线路等，可按需分场景实施
- 设备和计算安全：同属数据中心改造内容，重点考察数据中心中各具体设备的一些功能。一是设备尽量满足，二是部分功能点 可能涉及二次开发补足
- 应用和数据安全：**为云平台改造重点**。重点项 有以下几点，各送测单位 需根据平台实际，进行针对性改造：
  - 身份认证
  - 访问控制
  - 数据保护

注：最后一点，别看这里只罗列了三点。但实际实施起来，会涉及到很多对象，牵扯出对应的改造内容。比如，如何定义"重要数据"？因各家平台实现不一致，这里我也不再额外展开了。

以上，是对密评实施的一些简要阐述。额外提一点，"密评"复杂的地方，其实还不光是上文这些改造项；从这里**衍生出来的需求，后续复杂度甚至可能超过"密评"改造本身**。简单说下，各位可自行感受：

- 现有项目/局点升级以支持国密场景
- 安全设备/方案的选型/异构支持

- 安全设备异常的应急预案
- ...

上面罗列的各类问题，都需要在设计"密评"方案时提前考虑，防止项目上线后进行大幅度变更，那就得不偿失了。

<br/>

## 有关测评

整个测评过程，大体分为三个阶段。比较特别的地方，我将其归纳为要"**先审再改后验**"。这里逐步解释下：

- 前期评估
  - 自查自评：企业在确定参与"密评"测试后，需结合条例要求，进行满足度自评
  - 制定方案：企业可选取具备资质的测评机构，进行测评咨询与指导；形成正式的《密码应用方案》用于评审
  - 方案评审：企业需邀请相关业界专家、测评机构等，组织专项评审会议；不合适的方案需重新调整。方案相关过程件需归档

- 方案实施
  - 改造实施：企业需遵循之前评审建议，对数据中心进行国密改造。设备采购、业务验证等步骤，统一包含在此过程中

- 后期验收
  - 测评验收：企业需邀请另一家具备资质的测评机构，对改造后的数据中心，进行整体测评。根据各验收项，逐个判定符合度并进行打分
  - 结果上报：测评机构在完成验收后，编制相关测评报告，上报国密局验收。（*企业也可能需按评审重新整改；则重复以上过程*）


以上，是一个标准数据中心进行"密评"改造的整个活动周期。<u>按之前经验评估，整个过程大致需要小半年时间</u>。项目后续还需要定期进行复验。

不过，如前文所述，"密评"条例，是于去年底正式颁布实施。所以，目前测评本身，甚至于"密评"标准本身，其中还是有一些没那么明确/未达成业界共识的点。就我自己经手的项目来看，感觉各地对于不同条例的具体考察方式，是存在差异的；不同测评机构对部分测评项目的理解，存在不同的要求。这个不明确性，可能也间接影响到了整个测评的一些速度，毕竟没"等保" 那么明确。（*注：这一点，在我近期参与信通院的"密码+应用"工作组2022年第一次年会上，也有几位专家提到，还需加快落地*）

此外，需要额外提醒的一点，是整个数据中心的改造与实现，请尽量考虑采取较通用的方式来实施。在实施中，需**提前考虑/预留可自证的证据/锚点**，供后续取证；否则后续验收时会带来很多沟通和验收成本。

<br/>

## 成果

这里了，写点吹牛的东西。。我作为技术负责人完成"密评" 验收的项目，在所在省是首个通过验收的云平台，也是当前该省"密评"测评中获得的最高分。  ：）

<br/>

## 后续

要收尾了。这里写写展望吧～

上文列到的一些"密评"之外的一些未落地的部分，是需要及时补足的。此外，信创方向是能看到的一个很好的结合点，如何切入也是一个值得研究的部分。

以上，是我对之前参与整个"密评"工作的一些体会和感受，也算是对之前日子的纪念吧。

感谢你，能看到这里；希望以上信息对你有用。
